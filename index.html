<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Mahasiswa</title>

<style>
*{box-sizing:border-box;font-family:"Segoe UI",sans-serif}
body{background:#f3f4f6;padding:30px}

/* Card */
.container{
max-width:1000px;margin:auto;background:#fff;padding:25px;
border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.1)
}

h1,h2{text-align:center;color:#1f2937}

/* Form */
.form-table td{padding:10px}
input,textarea,select{
width:100%;padding:10px;border-radius:8px;
border:1px solid #d1d5db;transition:.3s
}
input:focus,textarea:focus,select:focus{border-color:#2563eb}

/* Buttons */
button{
padding:10px 15px;border:none;border-radius:8px;
cursor:pointer;font-weight:600;transition:.3s
}
.btn-primary{background:#2563eb;color:#fff}
.btn-primary:hover{background:#1e40af;transform:translateY(-2px)}
.btn-secondary{background:#e5e7eb}
.btn-secondary:hover{background:#d1d5db}

.btn-danger{background:#ef4444;color:white}
.btn-danger:hover{background:#dc2626}

.btn-edit{background:#10b981;color:white}
.btn-edit:hover{background:#059669}

/* Table */
table{width:100%;border-collapse:collapse;margin-top:15px}
th{background:#2563eb;color:white;padding:12px}
td{padding:10px;text-align:center;border-bottom:1px solid #e5e7eb}
tr:hover{background:#f9fafb}

/* Search */
.search-box{
margin:20px 0;
display:flex;gap:10px
}

/* Export */
.export{
display:flex;gap:10px;justify-content:center;margin-top:15px
}
</style>
</head>

<body>

<div class="container">
<h1>FORMULIR MAHASISWA</h1>

<table class="form-table">
<tr><td>Nama</td><td><input id="nama"></td></tr>
<tr><td>Alamat</td><td><input id="alamat"></td></tr>
<tr><td>NIM</td><td><input id="nim" type="number"></td></tr>

<tr>
<td>Jenis Kelamin</td>
<td>
<input type="radio" name="jk" value="Laki-Laki"> Laki-Laki
<input type="radio" name="jk" value="Perempuan"> Perempuan
</td>
</tr>

<tr>
<td>Hobi</td>
<td>
<input type="checkbox" name="hobi" value="Bola"> Bola
<input type="checkbox" name="hobi" value="Game"> Game
</td>
</tr>

<tr>
<td>Jurusan</td>
<td>
<select id="jurusan">
<option>Matematika</option>
<option>Biologi</option>
</select>
</td>
</tr>

<tr>
<td>Deskripsi</td>
<td><textarea id="deskripsi"></textarea></td>
</tr>

<tr>
<td></td>
<td>
<button class="btn-primary" onclick="simpan()">Simpan</button>
<button class="btn-secondary" onclick="resetForm()">Reset</button>
</td>
</tr>
</table>

<!-- SEARCH -->
<div class="search-box">
<input placeholder="Cari data..." onkeyup="cari(this.value)">
</div>

<!-- EXPORT -->
<div class="export">
<button class="btn-primary" onclick="exportExcel()">Export Excel</button>
<button class="btn-secondary" onclick="window.print()">Export PDF</button>
<button class="btn-danger" onclick="hapusSemua()">Hapus Semua</button>
</div>

<h2>Data Mahasiswa</h2>
<table id="tabel">
<thead>
<tr>
<th>Nama</th><th>Alamat</th><th>NIM</th>
<th>JK</th><th>Hobi</th><th>Jurusan</th>
<th>Deskripsi</th><th>Aksi</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
let editIndex = null;

window.onload = tampilkan;

function simpan(){
let data = JSON.parse(localStorage.getItem("mhs")) || [];

let obj = {
nama:nama.value,
alamat:alamat.value,
nim:nim.value,
jk:document.querySelector("input[name=jk]:checked")?.value || "",
hobi:[...document.querySelectorAll("input[name=hobi]:checked")].map(h=>h.value).join(", "),
jurusan:jurusan.value,
deskripsi:deskripsi.value
};

if(!obj.nama || !obj.nim) return alert("Nama & NIM wajib!");

if(editIndex!==null){
data[editIndex]=obj;
editIndex=null;
}else data.push(obj);

localStorage.setItem("mhs",JSON.stringify(data));
tampilkan();resetForm();
}

function tampilkan(){
let data = JSON.parse(localStorage.getItem("mhs")) || [];
let tbody = document.querySelector("tbody");
tbody.innerHTML="";
data.forEach((m,i)=>{
tbody.innerHTML+=`
<tr>
<td>${m.nama}</td><td>${m.alamat}</td><td>${m.nim}</td>
<td>${m.jk}</td><td>${m.hobi}</td><td>${m.jurusan}</td>
<td>${m.deskripsi}</td>
<td>
<button class="btn-edit" onclick="edit(${i})">Edit</button>
<button class="btn-danger" onclick="hapus(${i})">Hapus</button>
</td>
</tr>`;
});
}

function edit(i){
let d=JSON.parse(localStorage.getItem("mhs"))[i];
nama.value=d.nama;alamat.value=d.alamat;nim.value=d.nim;
jurusan.value=d.jurusan;deskripsi.value=d.deskripsi;
document.querySelectorAll("input[name=jk]").forEach(r=>r.checked=r.value===d.jk);
document.querySelectorAll("input[name=hobi]").forEach(c=>c.checked=d.hobi.includes(c.value));
editIndex=i;
}

function hapus(i){
let d=JSON.parse(localStorage.getItem("mhs"));
if(confirm("Hapus data?")){
d.splice(i,1);
localStorage.setItem("mhs",JSON.stringify(d));
tampilkan();
}
}

function hapusSemua(){
if(confirm("Hapus semua data?")){
localStorage.removeItem("mhs");
tampilkan();
}
}

function resetForm(){
document.querySelectorAll("input,textarea").forEach(i=>i.value="");
document.querySelectorAll("input[type=radio],input[type=checkbox]").forEach(i=>i.checked=false);
editIndex=null;
}

/* SEARCH */
function cari(k){
k=k.toLowerCase();
document.querySelectorAll("tbody tr").forEach(r=>{
r.style.display=r.innerText.toLowerCase().includes(k)?"":"none";
});
}

/* EXPORT EXCEL */
function exportExcel(){
let table=document.getElementById("tabel").outerHTML;
let blob=new Blob([table],{type:"application/vnd.ms-excel"});
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="data_mahasiswa.xls";
a.click();
}
</script>

</body>
</html>
