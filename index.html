<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formulir Mahasiswa</title>

<!-- jsPDF & SheetJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{
  background:#f3f4f6;
  padding:30px;
}
.container{
  max-width:1100px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:18px;
  box-shadow:0 20px 40px rgba(0,0,0,.1);
  animation:fadeIn .6s ease;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1}}

h1,h2{text-align:center;color:#1f2937;margin-bottom:20px}

/* FORM */
.form-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:18px;
}
.form-group label{
  font-weight:600;
  font-size:14px;
}
.form-group input,
.form-group select,
.form-group textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #d1d5db;
  transition:.3s;
}
.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus{
  border-color:#2563eb;
  box-shadow:0 0 0 3px rgba(37,99,235,.2);
}
textarea{resize:none;height:90px}
.radio,.check{display:flex;gap:15px;margin-top:6px}
.full{grid-column:1/-1}

/* BUTTON */
.btn{
  padding:10px 18px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  transition:.3s;
}
.btn-primary{background:#2563eb;color:#fff}
.btn-primary:hover{background:#1d4ed8}
.btn-secondary{background:#e5e7eb}
.btn-danger{background:#ef4444;color:#fff}
.btn-warning{background:#f59e0b;color:#fff}
.btn:hover{transform:translateY(-2px)}

/* SEARCH */
.search{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #d1d5db;
  margin:25px 0;
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
thead{
  background:#2563eb;
  color:white;
}
th,td{
  padding:10px;
  text-align:center;
}
tbody tr{
  transition:.3s;
}
tbody tr:hover{
  background:#f1f5f9;
  transform:scale(1.01);
}

/* ACTION */
.actions{
  display:flex;
  gap:6px;
  justify-content:center;
}
.top-btn{
  display:flex;
  gap:10px;
  justify-content:center;
  margin-bottom:15px;
}
</style>
</head>

<body>
<div class="container">
<h1>FORMULIR MAHASISWA</h1>

<!-- FORM -->
<div class="form-grid">
  <div class="form-group">
    <label>Nama</label>
    <input type="text" id="nama">
  </div>
  <div class="form-group">
    <label>Alamat</label>
    <input type="text" id="alamat">
  </div>
  <div class="form-group">
    <label>NIM</label>
    <input type="number" id="nim">
  </div>
  <div class="form-group">
    <label>Jurusan</label>
    <select id="jurusan">
      <option>Matematika</option>
      <option>Informatika</option>
      <option>Biologi</option>
      <option>Fisika</option>
    </select>
  </div>

  <div class="form-group">
    <label>Jenis Kelamin</label>
    <div class="radio">
      <label><input type="radio" name="jk" value="Laki-Laki"> Laki-Laki</label>
      <label><input type="radio" name="jk" value="Perempuan"> Perempuan</label>
    </div>
  </div>

  <div class="form-group">
    <label>Hobi</label>
    <div class="check">
      <label><input type="checkbox" value="Bola"> Bola</label>
      <label><input type="checkbox" value="Game"> Game</label>
      <label><input type="checkbox" value="Membaca"> Membaca</label>
    </div>
  </div>

  <div class="form-group full">
    <label>Deskripsi</label>
    <textarea id="deskripsi"></textarea>
  </div>
</div>

<div style="text-align:center;margin-top:20px">
  <button class="btn btn-primary" onclick="simpan()">Simpan</button>
  <button class="btn btn-secondary" onclick="resetForm()">Reset</button>
</div>

<!-- SEARCH -->
<input type="text" class="search" placeholder="Cari data..." onkeyup="searchData(this.value)">

<div class="top-btn">
  <button class="btn btn-primary" onclick="exportExcel()">Export Excel</button>
  <button class="btn btn-warning" onclick="exportPDF()">Export PDF</button>
  <button class="btn btn-danger" onclick="hapusSemua()">Hapus Semua</button>
</div>

<h2>Data Mahasiswa</h2>

<table>
<thead>
<tr>
  <th>Nama</th>
  <th>Alamat</th>
  <th>NIM</th>
  <th>JK</th>
  <th>Hobi</th>
  <th>Jurusan</th>
  <th>Deskripsi</th>
  <th>Aksi</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table>
</div>

<script>
let editIndex = -1;

function getData(){
  return JSON.parse(localStorage.getItem("mahasiswa")) || [];
}

function simpan(){
  let data = getData();
  let mahasiswa = {
    nama:nama.value,
    alamat:alamat.value,
    nim:nim.value,
    jk:document.querySelector("input[name='jk']:checked")?.value || "",
    hobi:[...document.querySelectorAll(".check input:checked")].map(h=>h.value).join(", "),
    jurusan:jurusan.value,
    deskripsi:deskripsi.value
  };

  if(editIndex >= 0){
    data[editIndex] = mahasiswa;
    editIndex = -1;
  } else {
    data.push(mahasiswa);
  }

  localStorage.setItem("mahasiswa",JSON.stringify(data));
  tampil();
  resetForm();
}

function tampil(){
  let data = getData();
  tabel.innerHTML = "";
  data.forEach((m,i)=>{
    tabel.innerHTML += `
    <tr>
      <td>${m.nama}</td>
      <td>${m.alamat}</td>
      <td>${m.nim}</td>
      <td>${m.jk}</td>
      <td>${m.hobi}</td>
      <td>${m.jurusan}</td>
      <td>${m.deskripsi}</td>
      <td class="actions">
        <button class="btn btn-warning" onclick="edit(${i})">Edit</button>
        <button class="btn btn-danger" onclick="hapus(${i})">Hapus</button>
      </td>
    </tr>`;
  });
}

function edit(i){
  let m = getData()[i];
  nama.value = m.nama;
  alamat.value = m.alamat;
  nim.value = m.nim;
  jurusan.value = m.jurusan;
  deskripsi.value = m.deskripsi;
  document.querySelectorAll("input[name='jk']").forEach(r=>r.checked=r.value==m.jk);
  document.querySelectorAll(".check input").forEach(c=>c.checked=m.hobi.includes(c.value));
  editIndex = i;
}

function hapus(i){
  let data = getData();
  data.splice(i,1);
  localStorage.setItem("mahasiswa",JSON.stringify(data));
  tampil();
}

function hapusSemua(){
  if(confirm("Hapus semua data?")){
    localStorage.removeItem("mahasiswa");
    tampil();
  }
}

function resetForm(){
  document.querySelectorAll("input,textarea").forEach(i=>i.value="");
  document.querySelectorAll("input[type=radio],input[type=checkbox]").forEach(i=>i.checked=false);
}

function searchData(k){
  let rows = document.querySelectorAll("#tabel tr");
  rows.forEach(r=>{
    r.style.display = r.innerText.toLowerCase().includes(k.toLowerCase()) ? "" : "none";
  });
}

function exportExcel(){
  let wb = XLSX.utils.book_new();
  let ws = XLSX.utils.json_to_sheet(getData());
  XLSX.utils.book_append_sheet(wb,ws,"Mahasiswa");
  XLSX.writeFile(wb,"data_mahasiswa.xlsx");
}

function exportPDF(){
  const {jsPDF} = window.jspdf;
  let doc = new jsPDF();
  doc.text("Data Mahasiswa",14,10);
  let y=20;
  getData().forEach(m=>{
    doc.text(`${m.nama} | ${m.nim} | ${m.jurusan}`,14,y);
    y+=8;
  });
  doc.save("data_mahasiswa.pdf");
}

window.onload = tampil;
</script>
</body>
</html>
